# Хранение данных: данные агента vs отчёты

Важное правило для архитектуры и реализации.

---

## Данные от агента (ingest)

**Храним только до следующего обновления.**

- Как только пришли **новые** данные от агента по этому тенанту/оценке — **старые данные (предыдущая отправка) стираются автоматически**.
- То есть хранится по сути **текущий снимок**: последний принятый пакет/receipt. История сырых отправок не накапливается.
- Ingest Inbox и привязка к оценке работают с этим «последним» состоянием; при новой отправке можно перезаписывать или заменять запись (в зависимости от реализации).

**Итог:** сырые данные клиента от агента — краткосрочные, перезаписываются при следующей отправке.

---

## Отчёты (report packages)

**Остаются в архиве.**

- Сгенерированные пакеты отчётов (Executive Summary, регистры и т.д.) **не удаляются** при новой отправке агента.
- Публикованные отчёты неизменяемы и хранятся как долгосрочный артефакт соответствия.
- **История и «даты» формируются из отчётов** — по ним видно, когда была оценка и какой был результат. Не из сырых данных агента.

**Итог:** долгосрочная память системы — отчёты в архиве; данные агента — только для текущего цикла сбора и генерации отчёта.

---

## Сводка

| Тип данных | Хранение |
|------------|----------|
| Данные от агента (пакет, receipt, manifest, dlp_report и т.д.) | До следующей отправки; при новых данных старые стираются автоматически. |
| Отчёты (report packages, опубликованные) | В архиве постоянно; история/даты формируются из отчётов. |

При реализации ingest (приём, Inbox, привязка к оценке) в HIPAA SaaS нужно закладывать эту логику: при новой успешной приёмке пакета по тенанту/оценке — обновлять или заменять текущий receipt/пакет, не копить все отправки. Долгосрочное хранение — только отчёты.
